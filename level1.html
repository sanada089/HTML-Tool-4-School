<!doctype html>
<html lang="de">


<head>
  <title>HTML-Tool</title>
  <meta charset="utf-8">
  <style>


    .item2 {
      grid-area: blocklyDiv;
    }

    .item3 {
      grid-area: HTMLPage;
    }

    .item4 {
      grid-area: HTMLCode;
    }


    .grid-container {
      display: grid;
      grid-template-areas: 'blocklyDiv HTMLPage' 'blocklyDiv HTMLCode';
      gap: 10px;
    }


    #blocklyDiv {
      height: 70vh;
      width: 60vw;
      display: grid;
      background-color: gold;
    }

    #HTMLCodeDiv {
      height: 45vh;
      width: 39vw;
      background-color: whitesmoke;
      display: grid;
      overflow: scroll;
    }

    #HTMLPageDiv {
      height: 45vh;
      width: 39vw;
      display: grid;

    }

    #LevelSelectionDiv {
      height: 5vh;
      width: 100vw;
      background-color: lightskyblue;
      margin-bottom: 20px;
    }


    .levelButton {
      border: none;
      color: white;
      text-align: center;
      margin: 4px 2px;
      cursor: pointer;
      font-size: 24px;
      background-color: lightskyblue;
    }

    .popup {
      position: relative;
      display: inline-block;
      cursor: pointer;
    }

    .popup .popuptext {
      visibility: hidden;
      width: 160px;
      background-color: #555;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 8px 0;
      position: absolute;
      z-index: 1;
      bottom: 100%;
      left: 100%;
      margin-left: -80px;
    }

    /* Popup arrow */
    .popup .popuptext::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #555 transparent transparent transparent;
    }

    /* Toggle this class when clicking on the popup container (hide and show the popup) */
    .popup .show {
      visibility: visible;
      -webkit-animation: fadeIn 1s;
      animation: fadeIn 1s
    }

    .popup1 {
      position: relative;
      display: inline-block;
      cursor: pointer;
    }

    .popup1 .popuptext1 {
      visibility: hidden;
      width: 160px;
      background-color: #555;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 8px 0;
      position: absolute;
      z-index: 1;
      bottom: 100%;
      left: 100%;
      margin-left: -80px;
    }

    /* Popup arrow */
    .popup1 .popuptext1::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #555 transparent transparent transparent;
    }

    /* Toggle this class when clicking on the popup container (hide and show the popup) */
    .popup1 .show {
      visibility: visible;
      -webkit-animation: fadeIn 1s;
      animation: fadeIn 1s
    }

  </style>

  <!-- Laden der benötigten Blockly-Module -->

  <script src="node_modules/blockly/blockly_compressed.js"></script>
  <script src="node_modules/blockly/blocks_compressed.js"></script>

  <!-- Laden der benötigten Blockly-Sprachfiles für deutsche Sprache -->

  <script src="node_modules/blockly/msg/de.js"></script>
  <script>
    // When the user clicks on <div>, open the popup
    function myFunction() {
      var popup = document.getElementById('myPopup');
      popup.classList.toggle('show');
    }
  </script>

  <script>
    // When the user clicks on <div>, open the popup
    function myFunction1() {
      var popup1 = document.getElementById('myPopup1');
      popup1.classList.toggle('show');
    }
  </script>

</head>

<body>

<!-- Laden der benötigten Javascript-Files aus dem Unterverzeichnis js -->

<script src="js/html_blocks.js"></script>
<script src="js/html_generator.js"></script>
<script src="js/main.js"></script>

<!-- Leiste zur Auswahl von Leveln -->

<div id="LevelSelectionDiv">
  <!-- Buttons für die verschiedenen Level mit Weiterleitung auf den zugehörigen HTML-File -->
  <button class="levelButton" onclick="location.href='level1.html'">Level 1</button>
</div>

<!-- Kompletter Mittelteil der Seite, der komplette grid mit zugehörigen divs -->

<div class="grid-container">
  <div class="item2">
    <div id="blocklyDiv"></div>
  </div>
  <!-- Hier wird der Preview iframe, der in der update-Funktion im Script-Block befüllt wird in die HTMLPageDiv geladen -->
  <div class="item3">
    <iframe name="preview" id="HTMLPageDiv"></iframe>
  </div>
  <div class="item4">
    <div id="HTMLCodeDiv"></div>
  </div>
</div>


<div class="popup" onclick="myFunction()">
  <img src="istockphoto-1014757370-612x612.jpg" style="width:100px;height:200px;">
  <span class="popuptext" id="myPopup">Hallo, ich bin Herr Hausl
  <audio id="audio_with_controls" controls>

    <source src="Hallo.ogg" type="audio/ogg"/>

</audio>
  </span>
</div>

<div class="popup1" onclick="myFunction1()">
  <img src="istockphoto-834467010-612x612.jpg" style="width:200px;height:200px;">
  <span class="popuptext1" id="myPopup1">Hallo, ich bin Frau Gscheidhaferl</span>
</div>

<!-- Beginn Skript-Block -->

<script>

  // Einfügen des Blockly-Workspace mit zugehöriger Toolbox in die blocklyDiv
  const workspace = Blockly.inject('blocklyDiv', {toolbox: toolbox});

  /* Update-Funktion, die aufgerufen wird, wenn sich im Workspace etwas ändert und dann der HTMLCodeDiv also der
  Code-Anzeige den bisher in den Blöcken verwendeten Code zuweist
  Zusätzlich wird ein IFrame erstellt um eine Preview des bisher generierten Codes zu erzeugen
   */

  function update(event) {
    var code = HtmlGenerator.workspaceToCode(workspace);
    document.getElementById('HTMLCodeDiv').innerText = code;

    const ifr = document.preview;
    const html = code;
    ifr.document.write(html);
    ifr.document.close();

  }


  //Aufruf der Updatefunktion, sobald eine Änderung im workspace passiert

  workspace.addChangeListener(update);

</script>


</body>

</html>
